# Swow

[English](./README.md) | ä¸­æ–‡

[![license][license-badge]][license-link]
[![ci][ci-badge]][ci-link]
[![codecov][codecov-badge]][codecov-link]
[![release][release-badge]][release-link]
![â¤ï¸][made-with-love-badge]
![php][supported-php-versions-badge]
![platform][supported-platforms-badge]
![architecture][supported-architectures-badge]

> âš ï¸ é¢„è§ˆç‰ˆæœ¬ï¼Œéç”Ÿäº§å¯ç”¨

**Swowæ˜¯ä¸€ä¸ªä½¿ç”¨PHPå’ŒCç¼–å†™çš„é«˜æ€§èƒ½çº¯åç¨‹ç½‘ç»œé€šä¿¡å¼•æ“**ã€‚

å®ƒè‡´åŠ›äºä½¿ç”¨æœ€å°Cæ ¸å¿ƒåŠå¤šæ•°PHPä»£ç ä»¥æ”¯æŒPHPé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹ã€‚

## ğŸš€ åç¨‹

Swowå®ç°äº†ä¸€å¥—æœ‰å²ä»¥æ¥æœ€å®Œæ•´çš„PHPåç¨‹æ¨¡å‹ï¼Œå®ƒå…¨é¢é‡Šæ”¾äº†PHPçš„çœŸæ­£å®åŠ›ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åšåˆ°ä»¥å¾€éš¾ä»¥æƒ³è±¡çš„äº‹æƒ…ã€‚

### âš¡ï¸é«˜æ€§èƒ½âš¡ï¸

æ”¯æŒæ¯ç§’ç™¾ä¸‡æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ä¸”ç”±äºSwowæ”¯æŒçº¯Cåç¨‹ä¸PHPåç¨‹æ··åˆè¿è¡Œï¼Œä¸¤è€…ä¹‹é—´ä»…è¿›è¡ŒCæ ˆå•æ ˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¸”Swowçš„äº‹ä»¶è°ƒåº¦å™¨å°±æ˜¯çº¯Cåç¨‹ï¼Œå› æ­¤å¤§éƒ¨åˆ†åç¨‹åˆ‡æ¢éƒ½æ˜¯å•æ ˆåˆ‡æ¢ï¼Œå…¶åˆ‡æ¢é€Ÿåº¦è¿œè¶…C + PHPçš„åŒæ ˆåˆ‡æ¢ã€‚

### ğŸ’«é«˜å¯æ§ğŸ’«

ç°åœ¨åç¨‹å¯ä»¥ä½¿å¾—PHPè™šæ‹Ÿæœºåƒä¸€ä¸ªè¿·ä½ æ“ä½œç³»ç»Ÿä¸€æ ·ï¼Œå…¶ä¸­è¿è¡Œçš„åç¨‹è¿‘ä¼¼äºæ“ä½œç³»ç»Ÿçš„è¿›ç¨‹/çº¿ç¨‹ï¼Œå¼€å‘è€…èƒ½å¤Ÿä»¥è¶…ç»†ç²’åº¦ä»»æ„æ“æ§è¿™äº›åç¨‹ï¼Œå¦‚æŸ¥çœ‹æ‰€æœ‰åç¨‹çš„è¿è¡ŒçŠ¶æ€ã€attachè¿›å…¥åç¨‹ã€å•æ­¥è°ƒè¯•è·Ÿè¸ªã€æŸ¥çœ‹åç¨‹æ ˆä¹ƒè‡³æ¯ä¸ªæ ˆå¸§ã€æŸ¥çœ‹æˆ–ä¿®æ”¹åç¨‹å†…å˜é‡ã€ä¸­æ–­åç¨‹æˆ–æ€æ­»åç¨‹ç­‰ã€‚

åŸºäºè¿™æ ·çš„å¯æ§æ€§ï¼Œå¼€å‘è€…è¿˜å¯ä»¥å€ŸåŠ©WatchDogç»„ä»¶å¯¹é™·å…¥æ­»å¾ªç¯æˆ–å¤„äºIOé˜»å¡çš„åç¨‹è¿›è¡Œè­¦æŠ¥ã€ä¸­æ–­ã€è®©å‡ºç”šè‡³æ€æ­»ç­‰å¤šç§å¤„ç†ï¼Œä»¥é¿å…ä¸ªåˆ«åç¨‹å½±å“åˆ°ç¨‹åºæ•´ä½“ç¨³å®šæ€§ã€‚

å¹¶ä¸”ï¼Œå…¶ä¸è¿›ç¨‹è®¾è®¡å“²å­¦çš„å¥‘åˆæ€§ï¼Œä¹Ÿå†³å®šäº†åç¨‹åº”ç”¨çš„å¥å£®æ€§æä½³ã€‚æ­£å¦‚å•ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„å´©æºƒä¸€æ ·ï¼Œå•ä¸ªåç¨‹çš„å´©æºƒä¹Ÿä¸ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹çš„å´©æºƒï¼Œå¹¶ä¸”å¾—ç›ŠäºPHPå¼ºå¤§çš„å¼‚å¸¸æœºåˆ¶å’Œèµ„æºç®¡ç†èƒ½åŠ›ï¼Œä¸åç¨‹ç»‘å®šçš„ç›¸å…³èµ„æºéƒ½èƒ½è¢«å®‰å…¨åœ°é‡Šæ”¾ã€‚ä½ æ— éœ€å†ä¸ºæœªæ•è·çš„å¼‚å¸¸æ®šç²¾ç«­åŠ›ï¼Œä¹Ÿä¸è¦å†å»æ•è·Throwableï¼Œé‡åˆ°æœªçŸ¥çš„é”™è¯¯è¯·Let it crashã€‚

### ğŸŒŸæ˜“å…¼å®¹ğŸŒŸ

æ— éœ€åˆ›å»ºåç¨‹ä¹Ÿæ— éœ€åˆ¤æ–­æ˜¯å¦åœ¨åç¨‹ç¯å¢ƒï¼Œåœ¨Swowä¸­ï¼Œæ‰€åŠä¹‹å¤„ï¼Œçš†ä¸ºåç¨‹ï¼Œæ‰“å¼€ç¼–è¾‘å™¨ï¼Œå³åˆ»å°±å¯ä»¥å¼€å§‹ä¹¦å†™ä½ çš„ä»£ç ï¼è¿™ä¹Ÿæ„å‘³ç€å®ƒå°†æ›´å¥½åœ°å…¼å®¹å·²æœ‰çš„ç”Ÿæ€ï¼Œæˆ‘ä»¬å†ä¹Ÿä¸éœ€è¦ä¸ºPHPUnité‡å†™ä¸€ä¸ªç”±åç¨‹åŒ…è£¹çš„å…¥å£ã€‚

## âš™ï¸ äº‹ä»¶é©±åŠ¨

SwowåŸºäºåç¨‹äº‹ä»¶åº“[**libcat**](https://github.com/libcat/libcat)å¼€å‘ï¼ŒlibcatåˆåŸºäºå¼‚æ­¥äº‹ä»¶åº“[**libuv**](https://github.com/libuv/libuv)å¼€å‘ï¼Œå¾—ç›Šäºæ­¤ï¼Œæˆ‘ä»¬æ‹¥æœ‰äº†ç»è¿‡å·¥ä¸šçº§éªŒè¯çš„äº‹ä»¶å¾ªç¯é©±åŠ¨ï¼Œå¹¶ä¸”å®ƒæ”¯æŒå‡ ä¹æ‰€æœ‰å¸¸è§æ“ä½œç³»ç»Ÿã€‚å› æ­¤ï¼ŒSwowä¹Ÿæ˜¯é¦–ä¸ªèƒ½åœ¨åŸç”ŸWindowså¹³å°è¿è¡Œï¼Œä¸”é€šè¿‡IOCPé©±åŠ¨çš„PHPåç¨‹ç½‘ç»œç¼–ç¨‹å¼•æ“ã€‚ç”±äºlibuvéµå¾ªProactoræ¨¡å‹ï¼Œä¸ä¹…åæˆ‘ä»¬åˆå¯ä»¥åœ¨Linuxä¸‹å…è´¹è·å¾—ç”±æ–°ç‰¹æ€§io_uringå¸¦æ¥çš„å¯è§‚æ€§èƒ½æå‡ã€‚

## ğŸ˜ PHPå¯ç¼–ç¨‹æ€§

æœ€å°Cæ ¸å¿ƒæ„å‘³ç€åº•å±‚ä¸å†åŒ…æ½æ‰€æœ‰äº‹åŠ¡ï¼Œè€Œæ˜¯ä»…æä¾›æœ€ç»†ç²’åº¦çš„åŸºç¡€æ¥å£ï¼Œå³æ‰©å±•å±‚ä¸å†åƒæ˜¯ä¸€ä¸ªæ¡†æ¶(framework)ï¼Œè€Œæ›´åƒæ˜¯åº“(library)ï¼Œè¿™å°†ä½¿PHPçš„ç¼–ç¨‹èƒ½åŠ›æœ€å¤§åŒ–ã€‚

ä¸”éšç€PHP8å’ŒJITçš„åˆ°æ¥ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦å¤§é‡ä½¿ç”¨Cæˆ–æ˜¯C++æ¥å®Œæˆé‚£äº›PHPä¹Ÿèƒ½åšåˆ°çš„å·¥ä½œå‘¢ï¼Ÿæ›´å¤šåœ°ä½¿ç”¨PHPè€Œä¸æ˜¯Cã€C++ï¼Œä¹Ÿå¥‘åˆäº†PHPå†…æ ¸çš„æœªæ¥å‘å±•æ–¹å‘ã€‚

æ›´å¼ºçš„å¯ç¼–ç¨‹æ€§ä¹Ÿå¸¦æ¥äº†æ›´å¤šçš„å¯èƒ½æ€§ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œæ›¾ç»ä½ æƒ³å†™ä¸€ä¸ªç®€å•çš„WAFç¨‹åºï¼Œé€šè¿‡æ£€æµ‹IPæˆ–æ˜¯è§£æHTTPå¤´éƒ¨æ¥å®æ–½ä¸€äº›é‰´æƒæ“ä½œï¼Œä½†å½“ä½ åœ¨å›è°ƒä¸­æ‹¿åˆ°è¯·æ±‚å¯¹è±¡æ—¶ï¼Œåº•å±‚å·²ç»æ›¿ä½ å®Œæˆäº†æ•´ä¸ªè¯·æ±‚çš„æ¥æ”¶ï¼Œåºå¤§çš„HTTPæŠ¥æ–‡è§£ææˆ–è®¸å·²ç»æŸå®³äº†ä½ çš„ç¨‹åºæ€§èƒ½ã€‚

ä½†ç°åœ¨ï¼ŒSwowæä¾›çš„Bufferæ¨¡å—ä½¿å¾—PHPå¯ä»¥åƒCä¸€æ ·ç²¾ç»†åœ°è¿›è¡Œå†…å­˜ç®¡ç†ï¼Œç»“åˆSocketæ¨¡å—å’Œä¸€äº›åè®®è§£æå™¨ï¼Œå®ƒå…è®¸ä½ æŒæ¡å°åˆ°æ¯ä¸ªå­—èŠ‚çš„æ¥æ”¶å’Œè§£æï¼Œæˆ–è®¸åœ¨æœªæ¥å¼€å‘è€…å®Œå…¨å¯ä»¥ä½¿ç”¨Swowç¼–å†™é«˜æ€§èƒ½çš„ç½‘å…³ç¨‹åºï¼Œä¸€åˆ‡éƒ½å¯ä»¥é€šè¿‡PHPç¼–ç¨‹çš„æ–¹å¼æ”¹å˜ï¼Œä¸”å®ƒä»¬å…¨éƒ½æ˜¯å†…å­˜å®‰å…¨çš„ã€‚

## âœˆï¸ ç°ä»£åŒ–

### ğŸ˜é¢å‘å¯¹è±¡ğŸ˜

Swowåœ¨é¢å‘å¯¹è±¡çš„é“è·¯ä¸Šå’ŒPHPçš„è¿›åŒ–è·¯çº¿å¦‚å‡ºä¸€è¾™ï¼Œä¸ç®¡æ˜¯æ—©æœŸçš„PHPæˆ–æ˜¯å…¶å®ƒæœ‰æ‚ ä¹…å†å²çš„æ‰©å±•ï¼Œå¯¹äºAPIçš„è®¾è®¡å¤§éƒ½æ˜¯é¢å‘è¿‡ç¨‹çš„ï¼Œè€Œç»è¿‡å¤šå¹´å‘å±•ï¼ŒPHPç¤¾åŒºæ—©å·²æ˜¯é¢å‘å¯¹è±¡çš„å¤©ä¸‹ï¼ŒPHPä¹Ÿä¸ºå†…å»ºAPIçš„é¢å‘å¯¹è±¡æ”¯æŒè€Œä¸æ‡ˆåŠªåŠ›ã€‚é¢å‘å¯¹è±¡ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°åŸºäºSwowåº“è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç»§æ‰¿å†…éƒ¨ç±»å¹¶å®ç°PSRæ¥å£ä»¥0æˆæœ¬æ”¯æŒPSRè§„èŒƒï¼Œè¿™åœ¨å®é™…åº”ç”¨ä¸­è®©æˆ‘ä»¬çš„ç¨‹åºæ€§èƒ½å¾—åˆ°äº†æå¤§çš„æå‡ã€‚

### ğŸ›¡æ‹¥æŠ±å¼‚å¸¸ğŸ›¡

Swowåœ¨é”™è¯¯å¤„ç†æ–¹é¢å’ŒPHPçš„æ”¹é©ç†å¿µä¹Ÿæ˜¯ä¸€è‡´çš„ï¼ŒPHP8å¹²æ‰äº†å¤§é‡çš„noticeã€warningã€errorï¼Œè½¬è€Œä½¿ç”¨åŸºäºå¼‚å¸¸æœºåˆ¶çš„Error/Exceptionï¼Œæå¤§åœ°å¢å¼ºäº†ç¨‹åºçš„å¥å£®æ€§ï¼ˆä¸è¦å†è®©é”™è¯¯çš„ç¨‹åºç»§ç»­è¿è¡Œä¸‹å»ï¼‰ã€‚

æ›¾ç»æˆ‘ä»¬è¦æ±‚å¼€å‘è€…åœ¨æ¯ä¸ªIOæ“ä½œåæ£€æŸ¥è¿”å›å€¼ï¼Œå¦åˆ™ç¨‹åºå°±å¯èƒ½é™·å…¥éé¢„æœŸçš„é”™è¯¯çŠ¶æ€ä¸­ï¼Œè¿™æ ·çš„ç¼–ç æ–¹å¼ï¼Œæ— å¼‚äºæ˜¯ä¸€ç§å†å²çš„å€’é€€ï¼Œå¹²æ‰`if ($err != null)`ï¼Œæ‹¥æŠ±å¼‚å¸¸æœºåˆ¶ï¼Œæ‰æ˜¯æ­£ç¡®çš„å‘å±•é“è·¯ã€‚

è€ŒåŸºäºä¸Šè¿°æ”¹è¿›ï¼Œæˆ‘ä»¬ç°åœ¨èƒ½ä»¥é“¾å¼è°ƒç”¨çš„æ–¹å¼ä¹¦å†™ä»£ç ï¼Œä½¿ä»£ç å˜å¾—æ›´åŠ ç®€æ´ä¸”å¯Œæœ‰èŠ‚å¥æ„Ÿã€‚

## ğŸ€ ç»¿è‰²å¢å¼º

Swowå’ŒOpcacheéå¸¸ç›¸ä¼¼ï¼Œä¸¤è€…éƒ½å…è®¸å¼€å‘è€…åœ¨å‡ ä¹ä¸æ”¹å˜ä»£ç çš„æƒ…å†µä¸‹ï¼Œä»…é€šè¿‡å¼€å¯æ‰©å±•å°±èƒ½ä½¿å¾—åº”ç”¨ç¨‹åºè·å¾—å…è´¹å¤§é‡çš„èƒ½åŠ›æå‡ã€‚å³ä¿è¯ç›¸åŒçš„ä»£ç å…·æœ‰ä¸€è‡´çš„è¾“å‡ºç»“æœï¼Œä½†å®ƒä»¬åœ¨åº•å±‚æ‰€è¿è¡Œçš„æŒ‡ä»¤æˆ–æ˜¯ç³»ç»Ÿè°ƒç”¨å¯èƒ½ä¸å°½ç›¸åŒã€‚

å› æ­¤ï¼ŒSwowç†æ‰€å½“ç„¶åœ°æ”¯æŒæ‰€æœ‰SAPIï¼ˆCLIï¼ŒFPMç­‰ï¼‰ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå—åˆ¶äºFPMçš„æ¨¡å‹ï¼Œä½ æ— æ³•ç®€å•åœ°é€šè¿‡å¼€å¯Swowç›´æ¥è·å¾—æ€§èƒ½ä¸Šçš„æå‡ï¼Œä½†å®ƒä»èƒ½åœ¨åŠŸèƒ½ä¸Šå¯¹FPMè¿›è¡Œå¢å¼ºï¼ˆå¦‚å¹¶å‘è¯·æ±‚æ¥å£ã€æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ç­‰ï¼‰ã€‚

æ­¤å¤–ï¼Œå³ä½¿æ˜¯ä¼ ç»Ÿçš„åŒæ­¥é˜»å¡åº”ç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Swowç”Ÿæ€ä¸‹çš„åº”ç”¨ç»„ä»¶ï¼Œå¦‚ä½¿ç”¨Swowæä¾›çš„Debuggerå·¥å…·å¯¹ç¨‹åºè¿›è¡Œæ–­ç‚¹è°ƒè¯•åˆ†æç­‰ã€‚

## ğŸ’« çº¿ç¨‹å®‰å…¨

Swowæ”¯æŒåœ¨PHPçš„ZTSï¼ˆZend Thread Safetyï¼‰ç‰ˆæœ¬ä¸‹è¿è¡Œï¼Œå³åŸºäºå†…å­˜éš”ç¦»çš„å¤šçº¿ç¨‹æ”¯æŒã€‚

è¿™æ„å‘³ç€å®ƒå¯ä»¥å’Œ[parallel](https://www.php.net/manual/book.parallel.php)ã€[pthreads](https://www.php.net/manual/book.pthreads.php)ç­‰å¤šçº¿ç¨‹æ‰©å±•å¾ˆå¥½åœ°ç»“åˆä½¿ç”¨ï¼Œä½†Swowæœ¬èº«ä¸ä¼šæä¾›ä»»ä½•å¤šçº¿ç¨‹æ”¯æŒã€‚

## ğŸ£ å­¦ä¹ æˆæœ¬

Swowæ˜¯å¦åˆæ˜¯ä¸€ä¸ªå…¨æ–°çš„è½®å­ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚å¦‚æœä½ ç†Ÿæ‚‰å¦‚Swooleè¿™æ ·çš„åç¨‹åº“ï¼Œé‚£ä¹ˆä½ å‡ ä¹æ— éœ€ä»»ä½•å­¦ä¹ æˆæœ¬å°±å¯ä»¥ä¸Šæ‰‹Swowï¼Œåä¹‹ï¼ŒSwowå¯èƒ½æ›´æ˜“äºä¸Šæ‰‹ï¼Œå› ä¸ºå®ƒæ›´ç°ä»£åŒ–ï¼Œé¢å‘å¯¹è±¡ã€å¼‚å¸¸æœºåˆ¶ã€çº¯åç¨‹ã€é›¶å¼‚æ­¥å›è°ƒç­‰ä¸€åˆ‡ç‰¹æ€§éƒ½åªä¸ºäº†è®©ä½ çš„ç¼–ç æ›´åŠ ä»å®¹ä¼˜é›…ã€‚

æ­¤å¤–ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä½¿ç”¨äº†ç¤¾åŒºæµè¡Œåç¨‹æ¡†æ¶ï¼Œé‚£ä¹ˆå®ƒçš„å‡çº§æˆæœ¬å¯èƒ½ä»…å’Œç”±PHP5å‡çº§åˆ°PHP7ç›¸å½“ï¼Œå¹¶ä¸”ä½ è¿˜å¯èƒ½å› æ­¤è·å¾—20%çš„å…è´¹æ€§èƒ½æå‡å’Œå¯è§‚çš„å†…å­˜å ç”¨ç¼©å‡ã€‚

ç°é˜¶æ®µçš„Swowéå¸¸é€‚åˆæŠ€æœ¯å…ˆé©±å’Œæå®¢ä»¬å°é²œï¼Œå®ƒå°†èµ°åœ¨PHPå¼‚æ­¥åç¨‹æŠ€æœ¯çš„å‰æ²¿ï¼Œæ‹¥æŠ±å˜åŒ–ç”šè‡³å¼•é¢†å˜åŒ–ã€‚

## â›“ ç¼–ç¨‹ç†å¿µ

Swowéµå¾ªCSPçš„å¹¶å‘æ¨¡å‹ï¼Œè€Œä¸æ˜¯Callbackæ¨¡å‹ã€‚åœ¨å®ç°ä¸Šæ¥è¯´ï¼Œåç¨‹æ˜¯å¼‚æ­¥å›è°ƒçš„è¶…é›†ï¼Œé€šè¿‡åˆ›å»ºæ–°çš„åç¨‹å¯ä»¥æ¨¡æ‹Ÿå¼‚æ­¥å›è°ƒï¼Œè€Œåä¹‹åˆ™ä¸è¡Œã€‚

### ä¸¤ä¸ªé—®é¢˜

Swoole/Swowå¯¹äºå¹¶å‘ç½‘ç»œç¼–ç¨‹æ”¯æŒçš„æŠ€æœ¯æŠ‰æ‹©ç»ˆç»“äºå…‹æœä¸¤ä¸ªå·¨å¤§çš„ç°å®æŠ€æœ¯éš¾é¢˜ï¼šä¸€ä¸ªæ˜¯å›è°ƒåœ°ç‹±ï¼Œå¦ä¸€ä¸ªæ˜¯ç”Ÿæ€ã€‚

### ä¸€ä¸ªé€‰æ‹©

PHPå¼‚æ­¥ç½‘ç»œç¼–ç¨‹æŠ€æœ¯çš„å¥ åŸºè€…Swooleæ—©æœŸå°±å°è¯•äº†å¼‚æ­¥å›è°ƒæ¨¡å‹ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­è¯¥æŠ€æœ¯å¸¸å¸¸åˆ¶é€ å‡ºéš¾ä»¥ç»´æŠ¤çš„ä»£ç ï¼Œè€Œåç¨‹æŠ€æœ¯å¯ä»¥è§£å†³åµŒå¥—å¼‚æ­¥å›è°ƒä»£ç å¯ç»´æŠ¤æ€§æå·®çš„é—®é¢˜å¹¶å‡è½»å¼€å‘è€…çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚

è€Œé€‰æ‹©æœ‰æ ˆåç¨‹æŠ€æœ¯è€Œä¸æ˜¯æ— æ ˆåç¨‹ï¼Œåˆ™æ˜¯ä¸ºäº†æ›´å¥½åœ°å¤ç”¨å·²æœ‰çš„åºå¤§çš„PHPç”Ÿæ€ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå…¶å®ƒå·²çŸ¥çš„å¼‚æ­¥äº‹ä»¶åº“éƒ½èµ°åœ¨äº†ä¸PHPåŸæœ‰ç”Ÿæ€æ›´åŠ å‰²è£‚çš„æ–¹å‘ä¸Šã€‚åœ¨Swowä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®Œç¾å¤ç”¨å¤§é‡çš„PHPç½‘ç»œè®¾æ–½åº“åŠåŸºäºå®ƒä»¬å¼€å‘çš„æµ·é‡PHPåŒ…æ”¯æŒè€Œæ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç ã€‚

### åç¨‹æ€ç»´

æ­¤å¤–ï¼Œåœ¨çº¯åç¨‹çš„ç¼–ç¨‹ç†å¿µä¸­ï¼Œæˆ‘ä»¬ä¸åº”å†ä»¥å¼‚æ­¥å›è°ƒçš„æ–¹å¼å»æ€è€ƒä»£ç å®ç°ã€‚ä»¥å®ç°ä¸€ä¸ªæœ‰é™æ¬¡æ•°çš„å®šæ—¶ä»»åŠ¡ä¸ºä¾‹ï¼Œæˆ‘ä»¬ä¸å†åº”è¯¥å…ˆæƒ³åˆ°å¼‚æ­¥å®šæ—¶å™¨ï¼Œä½¿ç”¨å¼‚æ­¥å®šæ—¶å™¨å®ç°æˆ‘ä»¬éœ€è¦å€ŸåŠ©å…¨å±€å˜é‡ä¸Šä¸‹æ–‡ä¿å­˜çŠ¶æ€å¹¶å¯¹å…¶è®¡æ•°ï¼Œåœ¨æ‰§è¡ŒæŒ‡å®šæ¬¡æ•°ååˆ é™¤å®šæ—¶å™¨ï¼Œè€Œåœ¨åç¨‹çš„æ–¹å¼ä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°æ–°å»ºä¸€ä¸ªåç¨‹å¹¶forå¾ªç¯æŒ‡å®šæ¬¡æ•°ï¼Œæ¯æ¬¡å¾ªç¯é€šè¿‡sleep()æŒ‚èµ·æŒ‡å®šçš„æ—¶é—´ï¼Œå†æ‰§è¡Œä»»åŠ¡ã€‚

æ˜¾ç„¶åç¨‹æ–¹å¼çš„å¥½å¤„æ˜¯ä»£ç ç›´è§‚ä¸”ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸ä¼šä¸¢å¤±ã€‚å¼‚æ­¥å®šæ—¶å™¨çš„æ¯æ¬¡æ‰§è¡Œéƒ½éœ€è¦ä¸€ä¸ªå…¨æ–°çš„å›è°ƒå †æ ˆï¼Œåœ¨å¼‚æ­¥æ··åˆåç¨‹çš„å®ç°ä¸‹ï¼Œæ¯æ¬¡å›è°ƒéƒ½å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„åç¨‹ï¼Œæ­¤æ—¶çº¯åç¨‹å®ç°çš„å„ç§å¥½å¤„å°±ä¸è¨€è€Œå–»äº†ã€‚

## â³ å®‰è£…

> å’Œä»»ä½•å¼€æºé¡¹ç›®ä¸€æ ·, Swowæ€»æ˜¯åœ¨**æœ€æ–°çš„å‘è¡Œç‰ˆ**æä¾›æœ€å¼ºçš„ç¨³å®šæ€§å’ŒåŠŸèƒ½, è¯·å°½é‡ä¿è¯ä½ ä½¿ç”¨çš„æ˜¯æœ€æ–°ç‰ˆæœ¬

### ç¼–è¯‘éœ€æ±‚

- Linuxã€ Windowsã€macOSç­‰å¸¸è§æ“ä½œç³»ç»Ÿï¼ˆä¸[libuv](https://github.com/libuv/libuv/blob/v1.x/SUPPORTED_PLATFORMS.md)ä¸€è‡´ï¼‰
- PHP 8.0.0 æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œæ¨èä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ (ç‰ˆæœ¬è¶Šé«˜æ€§èƒ½è¶Šå¥½)

#### Composerå®‰è£…

```shell
composer require swow/swow:dev-develop
```

ç„¶åè¿è¡Œ`vendor/bin`ç›®å½•ä¸‹çš„è‡ªåŠ¨å®‰è£…å™¨`swow-builder`å³å¯å¼€å§‹å®‰è£…

| å‘½ä»¤ç¤ºä¾‹                                            | ç”¨é€”                |
| --------------------------------------------------- | ------------------- |
| ./vendor/bin/swow-builder                           | æ™®é€šæ„å»º            |
| ./vendor/bin/swow-builder --rebuild                 | é‡æ–°æ„å»º (æ¸…æ´æ„å»º) |
| ./vendor/bin/swow-builder --show-log                | æ„å»ºæ—¶æ˜¾ç¤ºæ—¥å¿—      |
| ./vendor/bin/swow-builder --debug                   | æ„å»ºdebugç‰ˆæœ¬       |
| ./vendor/bin/swow-builder --enable="--enable-debug" | æŒ‡å®šç‰¹æ®Šçš„æ„å»ºå‚æ•°  |

ä½¿ç”¨æ­¤æ–¹å¼å®‰è£…æ—¶ï¼Œæœ€åä¸€æ­¥ç¨‹åºä¼šä½¿ç”¨`sudo`å‘½ä»¤å®‰è£…Swowæ‰©å±•ï¼Œ`sudo`å¯èƒ½ä¼šè¯¢é—®ä½ ç®¡ç†å‘˜å¯†ç æ¥å®‰è£…Swowåˆ°ç³»ç»Ÿç›®å½•ã€‚

å®‰è£…ç¨‹åºä¹Ÿä¼šæä¾›ç±»ä¼¼äºä»¥ä¸‹çš„è¿è¡Œå‘½ä»¤ï¼š

`/usr/bin/env php -n -d extension=/path/to/vendor/swow/swow/ext/modules/swow.so --ri swow`

å³æ‰©å±•çš„soæ–‡ä»¶è¾“å‡ºåˆ°äº†ä½ é¡¹ç›®çš„vendorç›®å½•ä¸‹ï¼Œç›¸å½“äºæ‰©å±•ä¹Ÿæ‹¥æœ‰äº†ç‰ˆæœ¬æ§åˆ¶ï¼Œä½ å¯ä»¥ä¸ºä½ çš„æ¯ä¸ªé¡¹ç›®æŒ‡å®šä¸åŒç‰ˆæœ¬çš„Swowï¼Œè€Œæ— éœ€å…¨å±€ä½¿ç”¨åŒä¸€ä¸ªæ‰©å±•soã€‚

#### æ‰‹åŠ¨å®‰è£…æ‰©å±• (ä¸åŒ…å«PHPåº“éƒ¨åˆ†)

å…‹éš†é¡¹ç›®ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡Composerå¼•å…¥ï¼Œcdåˆ°`vendor/swow/swow/ext`ä¸­æ‰‹åŠ¨ç¼–è¯‘ï¼‰

```shell
git clone https://github.com/swow/swow.git
````

ç†Ÿæ‚‰çš„æ„å»ºä¸‰æ¿æ–§ï¼Œæœ€åä½¿ç”¨rootæƒé™å®‰è£…åˆ°ç³»ç»Ÿ

```shell
cd swow/ext && \
phpize && ./configure && make && \
sudo make install
```

#### Windowså®‰è£…

æ‰‹åŠ¨æ„å»ºè§[æ–‡æ¡£](https://wiki.s-wow.com/#/zh-cn/install?id=%e7%bc%96%e8%af%91%e5%ae%89%e8%a3%85-windows)ï¼Œä½ ä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å®˜æ–¹DLLå‘å¸ƒã€‚

## â„¹ï¸ IDEåŠ©æ‰‹

å¾—ç›ŠäºSwowå®Œå–„çš„å¼ºç±»å‹å£°æ˜å’ŒPHP8å¯¹äºå†…ç½®å‡½æ•°ã€æ–¹æ³•å£°æ˜ä¿¡æ¯çš„å®Œå¤‡æ”¯æŒï¼Œä»…é€šè¿‡Composerå®‰è£…Swowå³å¯åœ¨ä½ çš„é¡¹ç›®ä¸­è·å¾—ç»ä½³çš„å†…ç½®ç±»ã€å‡½æ•°ã€æ–¹æ³•çš„IDEæç¤ºæ”¯æŒï¼Œç¼–ç¨‹ä½“éªŒè¿œè¶…ä»¥å¾€ã€‚

ä½ å¯ä»¥è‡ªè¡Œé˜…è§ˆ[å†…ç½®ç±»ã€å‡½æ•°ã€æ–¹æ³•](lib/src/Swow.php)çš„å£°æ˜æ–‡ä»¶ï¼Œå®ƒæ˜¯ç”±åå°„å·¥å…·**è‡ªåŠ¨ç”Ÿæˆ**çš„ï¼Œä½†å…¶è´¨é‡è¿œè¶…å…¶ä»–åŒç±»æ‰©å±•é€šè¿‡è‡ªåŠ¨åŒ–ç”Ÿæˆæ–¹å¼ç”Ÿæˆçš„å£°æ˜è´¨é‡ï¼Œä½ ç”šè‡³å¯ä»¥åœ¨IDEä¸­å€ŸåŠ©å…¶çœ‹åˆ°å†…ç½®å‡½æ•°ã€æ–¹æ³•çš„å‚æ•°é»˜è®¤å€¼ã€‚

å½“ç„¶ï¼Œæ›´è¯¦ç»†çš„APIæ–‡æ¡£ä¼šåœ¨æ–‡æ¡£ä¸­ä¸æ–­å®Œå–„ã€‚

## ğŸ“” ç¤ºä¾‹ä»£ç 

ä½ å¯ä»¥åœ¨æœ¬é¡¹ç›®çš„[examples](examples)ç›®å½•ä¸‹é˜…è§ˆç¤ºä¾‹æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¼šä¸æ–­æ–°å¢æ›´å¤šç¤ºä¾‹ï¼Œè¿½æ±‚è¾¾åˆ°ä»£ç å³æ–‡æ¡£ã€ç¤ºä¾‹å³æ•™ç¨‹çš„ç›®æ ‡ã€‚

åŸºäºSwowçš„å¼ºå¤§ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çŸ­çŸ­äºŒåå››è¡ŒåŸºç¡€ä»£ç å†™å‡ºä¸€ä¸ªé«˜æ€§èƒ½ã€å¥å£®æ€§å¼ºã€å¸¦å¿ƒè·³åŠŸèƒ½çš„[TCPå›æ˜¾æœåŠ¡å™¨](examples/tcp_server/heartbeat.php)ï¼Œä½ å¯ä»¥è¿è¡Œç¤ºä¾‹ä»£ç å¹¶ç”¨telnetè¿æ¥ä½“éªŒï¼

æˆ–æ˜¯ç”¨ä¸è¶…è¿‡ä¸€ç™¾è¡Œä»£ç å†™å‡ºä¸€ä¸ªç™¾Kçº§QPSçš„[HTTP+WebSocketæ··åˆæœåŠ¡å™¨](examples/http_server/mixed.php)ï¼Œæ•´ä¸ªç¤ºä¾‹çº¯åŒæ­¥ã€é›¶å¼‚æ­¥å›è°ƒï¼Œè¿˜é€šè¿‡å¼‚å¸¸æ•è·å¾ˆè½»æ¾åœ°å¤„ç†äº†å„ç§é”™è¯¯æƒ…å†µã€‚

Swowçš„[PHPæºä»£ç ](lib/src/Swow)ä¹Ÿæ˜¯è‰¯å¥½çš„ç¤ºä¾‹ï¼ŒSwowæ˜¯ä¸ºPHPè¯­è¨€å’Œç½‘ç»œç¼–ç¨‹å¼€å‘çˆ±å¥½è€…æ‰“é€ çš„ç¥å…µåˆ©å™¨ï¼Œæ›¾ç»ä¸å¯è§çš„åº•å±‚å®ç°ä»£ç ï¼Œç°åœ¨éƒ½èƒ½ä»¥PHPä»£ç çš„å½¢å¼å±•ç°åœ¨å¼€å‘è€…çš„çœ¼å‰ï¼Œå¹¶ä¸”ä½ å¯ä»¥è‡ªç”±ä¿®æ”¹å®ƒä»¬ï¼Œæ‰“é€ å‡ºä¸“å±äºä½ çš„å®šåˆ¶åŒ–HTTPæœåŠ¡å™¨ã€‚

## ğŸ›  å¼€å‘ & è®¨è®º

- **ä¸­æ–‡æ–‡æ¡£**ï¼š[https://wiki.s-wow.com](https://wiki.s-wow.com)ï¼ˆå°šæœªå®Œæˆï¼Œæ•¬è¯·æœŸå¾…ï¼‰
- **è®¡åˆ’åˆ—è¡¨**ï¼š[https://github.com/swow/swow/projects](https://github.com/swow/swow/projects)

[license-badge]: https://img.shields.io/badge/license-apache2-blue.svg
[license-link]: LICENSE
[ci-badge]: https://github.com/swow/swow/workflows/tests/badge.svg
[ci-link]: https://github.com/swow/swow/actions?query=workflow:tests
[codecov-badge]: https://codecov.io/gh/swow/swow/branch/develop/graph/badge.svg
[codecov-link]: https://codecov.io/gh/swow/swow
[release-badge]: https://img.shields.io/github/release/swow/swow.svg?style=flat-square
[release-link]: https://github.com/swow/swow/releases
[made-with-love-badge]: https://img.shields.io/badge/made%20with-%E2%9D%A4-f00
[supported-php-versions-badge]: https://img.shields.io/badge/php-8.0--8.2-royalblue.svg
[supported-platforms-badge]: https://img.shields.io/badge/platform-Win32%20|%20GNU/Linux%20|%20macOS%20|%20FreeBSD%20-gold
[supported-architectures-badge]: https://img.shields.io/badge/architecture-x86--64%20|%20ARM64%20|%20mips64el%20|%20riscv64%20-maroon
